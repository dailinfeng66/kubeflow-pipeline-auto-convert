# 组件总结

### 组件化的必要性

​	在机器学习的全流程中，分析人员的精力应该注重在机器学习流程本身而不是在程序的开发运行上。在机器学习程序的编写过程中，大部分功能代码块都是可以在机器学习程序中通用的。因此，如果将这些可通用的功能代码以低耦合、高内聚的方式划分为不同的功能组件，使用者可以通过拖拽计算组件的方式动态编排机器学习程序流程，便可以降低使用者的学习和开发成本、提高应用创建效率，使其精力主要放在机器学习本身而不是程序的开发上。

### 组件

组件是对逻辑的封装，是软件系统中的功能插件。可以将软件流程中一个或者是多个小的功能封装为一个组件，同时也可以将一个功能中的一小部分封装为一个组件，组件封装的粒度大小取决于用户（在自定义组件中）。这里可以将组件的封装粒度分为三类：

+ 粗粒度：封装粒度较大，一般粗粒度可以认为是一个完整的模型，用户只需要输入训练数据来训练模型。复杂度较低，自定义程度低。
+ 中等粒度：封装细粒度介于粗粒度和细粒度之间的，既可以定义模型，又有较为合适的复杂度。
+ 细粒度：封装粒度较小，也就是语句级的封装。复杂度较高，自定义程度高。

在当前组件的自动开发平台上，推荐使用中等粒度的组件化进行组件封装。 

在组件的使用时，不需要考虑组件的内部实现，只需要满足组件的接口规范即可。 组件内部的属性可以通过接口进行自定义。组件具有较高的可重用性，组件的数据接口，具有较高的兼容性，能够适配大多数的使用情况。每一个组件在平台上运行时都是一个单独的环境独立运行，互不干扰，并且不同的组件可以有不同的依赖环境。

##### <u>组件的划分</u>

​     在当前平台中，对机器学习代码的组件化是将实现特定功能的方法封装为一个组件，功能方法的细粒度推荐等于第三方库中功能方法实现的细粒度。例如将sklearn中的DecisionTreeClassifier封装为一个组件，当需要当前类的实例对象时便可以直接使用当前组件获得实例对象。

​     在进行功能的划分时，组件之间的数据传输应该是纯数据的方式，不应该存在其他引用或者方法传递的方式。在组件之间传输流动的只能够是数据而非其他。

### 组件化

组件化主要是指解耦复杂的代码时将多个功能模块拆分、重组的过程。组件化就是将一个复杂的代码结构分解为多个完成独立功能的组件，组件与组件之间具有低耦合性、组件内部具有高内聚性、组件的边界划分明确。组件是具有一定功能并且能够独立运行的，将各个组件以数据流的方式前后串联起来便可以组成一个完整的机器学习全流程。组件的开发和组件的使用相对独立。

组件化的优点：

+ 降低整个系统耦合度
+ 可维护性高
+ 组件重复使用率高，开发效率高

##### <u> 组件化的思路</u>

在组件化时应该遵循

+ 标准化的前提即，所有的方法在进行组件化的时候应该遵循当前平台的组件化标准。

+ 向外提供服务为基础，组件是从整个机器学习流程中抽象出来的功能单一且性能较为稳定的部分封装成的公共方法，并将所有的公共方法统一管理，以便于向外提供稳定可靠的计算服务。

+ 以组合式应用为目的，软件的核心是实现动态的拼接已有的组件形成可执行的机器学习全流程Pipeline，并将Pipeline送入调度器中进行调度运行。

### 组件分为哪些类型

在整个平台的运行当中组件的类型是可以包含任意类型的。

在实践中，机器学习流程包括一系列的阶段，包括数据预处理、特征处理、模型拟合以及结果验证或预测。例如，将一组文本文档进行分类包括分词、清理、特征提取、训练分类模型以及输出分类结果。这些阶段都可以看作是黑盒过程，并且可以包装成组件。当然，不同的实现方式便是一个不同的组件，实现同一个功能不同实现方式的组件便可以归为一类。

### 组件的来源

在当前开发的平台中，组件来源主要是分为三类，第一类是用户手动编写组件。第二类是扫描第三方开源库，将第三方开源库按照一定的规则进行组件化。第三类是扫描第三方开源项目，将第三方开源项目的源码按照一定的规则进行组件化。

##### 自动组件化的方法

采用自动化的方法，对用户手写的组件方法代码进行组件化代码格式的转换、对第三方开源库对API方法代码进行组件化格式的转换。这种方式主要是可以比较快速的完成代码的转换，在现有工程的基础之上，能够快速的将一个第三方工程集成到平台上。

### 其他组件化的方式

+ 使用训练好的模型部署，以API的方式提供预测服务，如华为文本识别、文档识别和在线文本翻译等采用训练好的模型进行部署，当数据来时直接进行预测。

+ 指定模型，用户自定义训练集来训练模型

+ Amazon SageMaker for MLOps： 需要使用一定的代码来编排基础的pipeline，或者是使用已有的pipeline；
+ Azure machine Learning（AML）:微软在公有云Azure上推出的基于Web使用的一项机器学习服务，其内置了多种基础的机器学习算法，但AML只能够在Azure上使用，不能够单独部署。AML的组件是基于单个算法的组件，一个算法是一个组件。组件划分的粒度是算法级别。
+ TensorFlow Hub：将开发好的模型以模块化的方式放在公共的模型仓库中，当需要使用模型时，只需要根据模型的URL进行模型加载即可。

### 组件的管理方式

组件应该分类别的统一放在组件仓库中集中管理，当需要使用到组件时，客户端程序可以从组件仓库中获取组件。当组件需要更新时，只需要对组件仓库中对应的组件进行上传即可。在使用组件进行机器学习流程编排时，可以选择不同版本的组件。

### 机器学习组件化搭载平台

当前平台采用Kubeflow作为组件流程PIpeline的
